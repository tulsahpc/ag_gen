/** \file ag_exploit.c
 * \author Kyle Cook <kylecook80@gmail.com>
 * \date June 2016
 * \copyright Copyright (C) The University of Tulsa - All Rights Reserved. Unauthorized copying or distribution of this file is strictly prohibited.
 */

#include <stdio.h>
#include <stdlib.h>

#include "ag_exploit.h"
#include "util.h"

int AGExploitPrint(struct AGExploit *exploit)
{
	if(exploit == NULL)
		return 1;

	printf("exploit #%d: %s\n", exploit->id, exploit->name);
	return 0;
}

int AGExploitFree(struct AGExploit *exploit)
{
	if(exploit == NULL)
		return 1;

	if(exploit->name != NULL)
		free(exploit->name);

	free(exploit);
	return 0;
}

int AGExploitListFree(struct AGExploitList *list)
{
	if(list == NULL)
		return 1;

	int len = list->len;
	for(int i=0; i<len; i++) {
		struct AGExploit *exploit = list->exploits[i];
		if(exploit != NULL)
			AGExploitFree(exploit);
	}

	free(list);
	return 0;
}
