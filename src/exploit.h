#ifndef EXPLOIT_HPP
#define EXPLOIT_HPP

#include <vector>
#include <memory>
#include <string>

#include "parameterized_quality.h"
#include "parameterized_topology.h"

class Exploit {
    int id;
    std::string name;
    int num_params;

    std::vector<ParameterizedQuality> preconds_q;
    std::vector<ParameterizedTopology> preconds_t;

    std::vector<ParameterizedQuality> postconds_q;
    std::vector<ParameterizedTopology> postconds_t;

    void fetch_preconds();

    void fetch_postconds();

public:
    Exploit(int preId, std::string &preName, int preNumParams);

    int get_id();

    std::string get_name();

    int get_num_params();

    void print_preconds_q();

    void print_preconds_t();

    void print_postconds_q();

    void print_postconds_t();

    void print_id();

    std::vector<ParameterizedQuality> precond_list_q();

    std::vector<ParameterizedTopology> precond_list_t();

    std::vector<ParameterizedQuality> postcond_list_q();

    std::vector<ParameterizedTopology> postcond_list_t();

    static std::vector<Exploit> fetch_all();

    static void print_all();
};

#endif // EXPLOIT_HPP
