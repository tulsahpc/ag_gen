%option prefix="ep"
%option outfile="exploit_scanner.c"
%option noyywrap

%{
#include <math.h>
#include "exploits_parser.tab.h"
%}

ID       [A-Za-z][A-Za-z0-9_]*

%%

exploit { return EXPLOIT; }
preconditions { return PRECONDITIONS; }
postconditions { return POSTCONDITIONS; }
insert { return INSERT; }
delete { return DELETE; }
quality { return QUALITY; }
topology { return TOPOLOGY; }

{ID} { eplval.i = strdup(eptext); return IDENTIFIER; }

"="	{ return EQ; }
":"	{ return COLON; }
";"	{ return SEMI; }
","	{ return COMMA; }
"."	{ return PERIOD; }
"(" { return LPAREN; }
")" { return RPAREN; }

[ \t\r\n]+	{}
. { printf( "Unrecognized character: (%s)\n", yytext) }

%%
